(function(e){"use strict";function t(e){return e&&"object"===typeof e&&"default"in e?e:{default:e}}var i=t(e),n=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),o=new(function(){function e(){}return e.prototype.initialize=function(){},e.prototype.select=function(){},e.prototype.deselect=function(){},e.prototype.enable=function(){},e.prototype.disable=function(){},e.prototype.isSelected=function(){return!1},e.prototype.isDisabled=function(){return!1},e.prototype.getListItem=function(){return document.createElement("div")},e.prototype.getSelectedItemBadge=function(){return document.createElement("div")},e.prototype.getLabel=function(){return"NULL_OPTION"},e.prototype.getValue=function(){return"NULL_OPTION"},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.isHidden=function(){return!1},e.prototype.focus=function(){},e}()),s=function(){function e(t,i){var n=this;this.documentKeydownListener=function(e){switch(e.key){case"Tab":e.stopPropagation(),n.closeDropdown();break;case"ArrowUp":e.stopPropagation(),e.preventDefault(),n.decrementItemFocus(),n.focusItem();break;case"ArrowDown":e.stopPropagation(),e.preventDefault(),n.incrementItemFocus(),n.focusItem();break;case"Enter":case"Spacebar":case" ":break;default:n.refocusFilter();break}},this.documentClickListener=function(e){n.div===e.target||n.div.contains(e.target)||n.closeDropdown()},this.fmsFocusListener=function(e){e.stopPropagation(),e.preventDefault(),n.viewBar.dispatchEvent(new MouseEvent("click"))},this.fmsMousedownListener=function(e){e.stopPropagation(),e.preventDefault()};var o=t.get(0);if(!(o instanceof HTMLSelectElement))throw new Error("JQuery target must be a select element.");var s=o,c=s.multiple;if(!c)throw new Error('Select element must have the "multiple" attribute.');var r=s.name;if(!r)throw new Error("Select element must have a name attribute.");this.name=r;var l=t.find("option").toArray();this.options=e.createOptions(this,r,l,i.items),this.selectAllOption=e.createSelectAllOption(this,r,i.selectAllText),this.filterInput=document.createElement("input"),this.filterInput.type="text",this.filterInput.placeholder=i.filterText,this.clearButton=document.createElement("button"),this.clearButton.type="button",this.clearButton.innerHTML="&times;",this.filter=document.createElement("div"),this.filter.append(this.filterInput,this.clearButton),this.items=document.createElement("div"),this.options.forEach((function(e){return n.items.append(e.getListItem())})),this.dropDown=document.createElement("div"),this.dropDown.append(this.filter,this.items),this.placeholder=document.createElement("span"),this.placeholder.textContent=i.placeholderText,this.selectedItems=document.createElement("span"),this.viewBar=document.createElement("div"),this.viewBar.append(this.placeholder,this.selectedItems),this.div=document.createElement("div"),this.div.id=s.id,this.div.append(this.viewBar,this.dropDown),this.caseSensitive=i.caseSensitive,this.disabled=s.disabled,this.allowEnablingAndDisabling=i.allowEnablingAndDisabling,this.filterText="",this.showing=new Array,this.focusable=new Array,this.itemFocus=-2}return e.createOptions=function(t,i,n,o){var s=n.map((function(n,o){return e.checkValue(n.value,n.label),new e.SingleOption(t,o,i,n.label,n.value,n.defaultSelected,n.disabled)})),c=n.length,r=o.map((function(n,o){var s=n[0],r=n[1],l=n[2],a=n[3];return e.checkValue(r,s),new e.SingleOption(t,c+o,i,s,r,l,a)})),l=s.concat(r),a={};return l.forEach((function(e){var t=e.getValue();if(void 0!==a[t])throw new Error("Duplicate value: "+e.getValue()+" ("+e.getLabel()+")");a[t]=1})),l},e.checkValue=function(e,t){if(""===e)throw new Error("Option "+t+" does not have an associated value.")},e.createSelectAllOption=function(t,i,o){return new(function(e){function s(){var n=e.call(this,t,-1,i,o,"",!1,!1)||this;return n.checkbox.indeterminate=!1,n}return n(s,e),s.prototype.markSelectAll=function(){this.checkbox.checked=!0,this.checkbox.indeterminate=!1},s.prototype.markSelectPartial=function(){this.checkbox.checked=!1,this.checkbox.indeterminate=!0},s.prototype.markSelectAllNotDisabled=function(){this.checkbox.checked=!0,this.checkbox.indeterminate=!0},s.prototype.markDeselect=function(){this.checkbox.checked=!1,this.checkbox.indeterminate=!1},s.prototype.select=function(){this.isDisabled()||this.fms.options.filter((function(e){return!e.isSelected()})).forEach((function(e){return e.select()}))},s.prototype.deselect=function(){this.isDisabled()||this.fms.options.filter((function(e){return e.isSelected()})).forEach((function(e){return e.deselect()}))},s.prototype.enable=function(){this.checkbox.disabled=!1},s.prototype.disable=function(){this.checkbox.disabled=!0},s}(e.SingleOption))},e.prototype.initialize=function(){this.options.forEach((function(e){return e.initialize()})),this.selectAllOption.initialize(),this.filterInput.className="form-control",this.clearButton.tabIndex=-1,this.filter.className="filter dropdown-item",this.items.className="items dropdown-item",this.dropDown.className="dropdown-menu",this.placeholder.className="placeholder",this.selectedItems.className="selected-items",this.viewBar.className="viewbar form-control dropdown-toggle",this.div.className="filter-multi-select dropdown",this.isDisabled()&&this.disableNoPermissionCheck(),this.attachDropdownListeners(),this.attachViewbarListeners(),this.closeDropdown()},e.prototype.log=function(e,t){},e.prototype.attachDropdownListeners=function(){var e=this;this.filterInput.addEventListener("keyup",(function(t){t.stopImmediatePropagation(),e.updateDropdownList();var i=e.showing.length;switch(t.key){case"Enter":if(1===i){var n=e.options[e.showing[0]];n.isDisabled()||(n.isSelected()?n.deselect():n.select(),e.clearFilterAndRefocus())}break;case"Escape":e.filterText.length>0?e.clearFilterAndRefocus():e.closeDropdown();break}}),!0),this.clearButton.addEventListener("click",(function(t){t.stopImmediatePropagation();var i=e.filterInput.value;i.length>0?e.clearFilterAndRefocus():e.closeDropdown()}),!0)},e.prototype.updateDropdownList=function(){var e=this.filterInput.value;e.length>0?this.selectAllOption.hide():this.selectAllOption.show();var t=new Array,i=new Array;this.caseSensitive?this.options.forEach((function(n,o){-1!==n.getLabel().indexOf(e)?(n.show(),t.push(o),n.isDisabled()||i.push(o)):n.hide()})):this.options.forEach((function(n,o){-1!==n.getLabel().toLowerCase().indexOf(e.toLowerCase())?(n.show(),t.push(o),n.isDisabled()||i.push(o)):n.hide()})),this.filterText=e,this.showing=t,this.focusable=i},e.prototype.clearFilterAndRefocus=function(){this.filterInput.value="",this.updateDropdownList(),this.refocusFilter()},e.prototype.refocusFilter=function(){this.filterInput.focus(),this.itemFocus=-2},e.prototype.attachViewbarListeners=function(){var e=this;this.viewBar.addEventListener("click",(function(t){e.isClosed()?e.openDropdown():e.closeDropdown()}))},e.prototype.isClosed=function(){return!this.dropDown.classList.contains("show")},e.prototype.setTabIndex=function(){this.isDisabled()?this.div.tabIndex=-1:this.isClosed()?this.div.tabIndex=0:this.div.tabIndex=-1},e.prototype.closeDropdown=function(){var e=this;document.removeEventListener("keydown",this.documentKeydownListener,!0),document.removeEventListener("click",this.documentClickListener,!0),this.dropDown.classList.remove("show"),setTimeout((function(){e.setTabIndex()}),100),this.div.addEventListener("mousedown",this.fmsMousedownListener,!0),this.div.addEventListener("focus",this.fmsFocusListener)},e.prototype.incrementItemFocus=function(){this.itemFocus>=this.focusable.length-1||0==this.focusable.length||(this.itemFocus++,-1==this.itemFocus&&this.selectAllOption.isHidden()&&this.itemFocus++)},e.prototype.decrementItemFocus=function(){this.itemFocus<=-2||(this.itemFocus--,-1==this.itemFocus&&this.selectAllOption.isHidden()&&this.itemFocus--)},e.prototype.focusItem=function(){-2===this.itemFocus?this.refocusFilter():-1===this.itemFocus?this.selectAllOption.focus():this.options[this.focusable[this.itemFocus]].focus()},e.prototype.openDropdown=function(){this.disabled||(this.div.removeEventListener("mousedown",this.fmsMousedownListener,!0),this.div.removeEventListener("focus",this.fmsFocusListener),this.dropDown.classList.add("show"),this.setTabIndex(),this.clearFilterAndRefocus(),document.addEventListener("keydown",this.documentKeydownListener,!0),document.addEventListener("click",this.documentClickListener,!0))},e.prototype.queueOption=function(e){-1!=this.options.indexOf(e)&&i["default"](this.selectedItems).append(e.getSelectedItemBadge())},e.prototype.unqueueOption=function(e){-1!=this.options.indexOf(e)&&i["default"](this.selectedItems).children('[data-id="'+e.getSelectedItemBadge().getAttribute("data-id")+'"]').remove()},e.prototype.update=function(){this.areAllSelected()?(this.selectAllOption.markSelectAll(),this.placeholder.hidden=!0):this.areSomeSelected()?this.areOnlyDeselectedAlsoDisabled()?(this.selectAllOption.markSelectAllNotDisabled(),this.placeholder.hidden=!0):(this.selectAllOption.markSelectPartial(),this.placeholder.hidden=!0):(this.selectAllOption.markDeselect(),this.placeholder.hidden=!1),this.areAllDisabled()?this.selectAllOption.disable():this.selectAllOption.enable()},e.prototype.areAllSelected=function(){return this.options.map((function(e){return e.isSelected()})).reduce((function(e,t){return e&&t}),!0)},e.prototype.areSomeSelected=function(){return this.options.map((function(e){return e.isSelected()})).reduce((function(e,t){return e||t}),!1)},e.prototype.areOnlyDeselectedAlsoDisabled=function(){return this.options.filter((function(e){return!e.isSelected()})).map((function(e){return e.isDisabled()})).reduce((function(e,t){return e&&t}),!0)},e.prototype.areAllDisabled=function(){return this.options.map((function(e){return e.isDisabled()})).reduce((function(e,t){return e&&t}),!0)},e.prototype.isEnablingAndDisablingPermitted=function(){return this.allowEnablingAndDisabling},e.prototype.getRootElement=function(){return this.div},e.prototype.hasOption=function(e){return this.getOption(e)!==o},e.prototype.getOption=function(e){for(var t=0,i=this.options;t<i.length;t++){var n=i[t];if(n.getValue()==e)return n}return o},e.prototype.selectOption=function(e){this.getOption(e).select()},e.prototype.deselectOption=function(e){this.getOption(e).deselect()},e.prototype.isOptionSelected=function(e){return this.getOption(e).isSelected()},e.prototype.enableOption=function(e){this.getOption(e).enable()},e.prototype.disableOption=function(e){this.getOption(e).disable()},e.prototype.isOptionDisabled=function(e){return this.getOption(e).isDisabled()},e.prototype.disable=function(){this.isEnablingAndDisablingPermitted()&&this.disableNoPermissionCheck()},e.prototype.disableNoPermissionCheck=function(){var e=this;this.options.forEach((function(t){return e.setBadgeDisabled(t)})),this.disabled=!0,this.div.classList.add("disabled"),this.viewBar.classList.remove("dropdown-toggle"),this.closeDropdown()},e.prototype.setBadgeDisabled=function(e){e.getSelectedItemBadge().classList.add("disabled")},e.prototype.enable=function(){var e=this;this.isEnablingAndDisablingPermitted()&&(this.options.forEach((function(t){t.isDisabled()||e.setBadgeEnabled(t)})),this.disabled=!1,this.div.classList.remove("disabled"),this.setTabIndex(),this.viewBar.classList.add("dropdown-toggle"))},e.prototype.setBadgeEnabled=function(e){e.getSelectedItemBadge().classList.remove("disabled")},e.prototype.isDisabled=function(){return this.disabled},e.prototype.selectAll=function(){this.selectAllOption.select()},e.prototype.deselectAll=function(){this.selectAllOption.deselect()},e.prototype.getSelectedOptions=function(e){void 0===e&&(e=!0);var t=this.options;if(!e){if(this.isDisabled())return new Array;t=t.filter((function(e){return!e.isDisabled()}))}return t=t.filter((function(e){return e.isSelected()})),t},e.prototype.getSelectedOptionsAsJson=function(e){void 0===e&&(e=!0);var t={},i=this.getSelectedOptions(e).map((function(e){return e.getValue()}));t[this.getName()]=i;var n=JSON.stringify(t,null,"  ");return n},e.prototype.getName=function(){return this.name},e.SingleOption=function(){function e(e,t,i,n,o,s,c){this.fms=e,this.div=document.createElement("div"),this.checkbox=document.createElement("input"),this.checkbox.type="checkbox";var r=i+"-"+t.toString(),l=r+"-chbx";this.checkbox.id=l,this.checkbox.name=i,this.checkbox.value=o,this.checkbox.checked=s,this.checkbox.disabled=c,this.labelFor=document.createElement("label"),this.labelFor.htmlFor=l,this.labelFor.textContent=n,this.div.append(this.checkbox,this.labelFor),this.closeButton=document.createElement("button"),this.closeButton.type="button",this.closeButton.innerHTML="&times;",this.selectedItemBadge=document.createElement("span"),this.selectedItemBadge.setAttribute("data-id",r),this.selectedItemBadge.textContent=n,this.selectedItemBadge.append(this.closeButton)}return e.prototype.log=function(e,t){},e.prototype.initialize=function(){var e=this;this.div.className="dropdown-item custom-control",this.checkbox.className="custom-control-input custom-checkbox",this.labelFor.className="custom-control-label",this.selectedItemBadge.className="item",this.isSelected()&&this.selectNoDisabledCheck(),this.isDisabled()&&this.disableNoPermissionCheck(),this.checkbox.addEventListener("change",(function(t){if(t.stopPropagation(),e.isDisabled()||e.fms.isDisabled())t.preventDefault();else{e.isSelected()?(e.select(),e.hide()):(e.deselect(),e.show());var i=e.fms.showing.length;1===i&&e.fms.clearFilterAndRefocus()}}),!0),this.checkbox.addEventListener("keyup",(function(t){switch(t.key){case"Enter":t.stopPropagation(),e.checkbox.dispatchEvent(new MouseEvent("click"));break}}),!0),this.closeButton.addEventListener("click",(function(t){t.stopPropagation(),e.isDisabled()||e.fms.isDisabled()||(e.deselect(),e.show(),e.fms.isClosed()||e.fms.refocusFilter())}),!0),this.checkbox.tabIndex=-1,this.closeButton.tabIndex=-1},e.prototype.select=function(){this.isDisabled()||this.selectNoDisabledCheck()},e.prototype.selectNoDisabledCheck=function(){this.checkbox.checked=!0,this.fms.queueOption(this),this.fms.update()},e.prototype.deselect=function(){this.isDisabled()||(this.checkbox.checked=!1,this.fms.unqueueOption(this),this.fms.update())},e.prototype.enable=function(){this.fms.isEnablingAndDisablingPermitted()&&(this.checkbox.disabled=!1,this.selectedItemBadge.classList.remove("disabled"),this.fms.update())},e.prototype.disable=function(){this.fms.isEnablingAndDisablingPermitted()&&this.disableNoPermissionCheck()},e.prototype.disableNoPermissionCheck=function(){this.checkbox.disabled=!0,this.selectedItemBadge.classList.add("disabled"),this.fms.update()},e.prototype.isSelected=function(){return this.checkbox.checked},e.prototype.isDisabled=function(){return this.checkbox.disabled},e.prototype.getListItem=function(){return this.div},e.prototype.getSelectedItemBadge=function(){return this.selectedItemBadge},e.prototype.getLabel=function(){return this.labelFor.textContent},e.prototype.getValue=function(){return this.checkbox.value},e.prototype.show=function(){this.div.hidden=!1},e.prototype.hide=function(){this.div.hidden=!0},e.prototype.isHidden=function(){return this.div.hidden},e.prototype.focus=function(){this.labelFor.focus()},e}(),e}();i["default"].fn.filterMultiSelect=function(e){var t=this;e=i["default"].extend({},i["default"].fn.filterMultiSelect.args,e),"undefined"===typeof e.placeholderText&&(e.placeholderText="nothing selected"),"undefined"===typeof e.filterText&&(e.filterText="Filter"),"undefined"===typeof e.selectAllText&&(e.selectAllText="Select All"),"undefined"===typeof e.caseSensitive&&(e.caseSensitive=!1),"undefined"===typeof e.allowEnablingAndDisabling&&(e.allowEnablingAndDisabling=!0),"undefined"===typeof e.items&&(e.items=new Array);var n=new s(t,e);n.initialize();var o=i["default"](n.getRootElement());t.replaceWith(o);var c={hasOption:function(e){return n.hasOption(e)},selectOption:function(e){n.selectOption(e)},deselectOption:function(e){n.deselectOption(e)},isOptionSelected:function(e){return n.isOptionSelected(e)},enableOption:function(e){n.enableOption(e)},disableOption:function(e){n.disableOption(e)},isOptionDisabled:function(e){return n.isOptionDisabled(e)},enable:function(){n.enable()},disable:function(){n.disable()},selectAll:function(){n.selectAll()},deselectAll:function(){n.deselectAll()},getSelectedOptionsAsJson:function(e){return void 0===e&&(e=!0),n.getSelectedOptionsAsJson(e)}};return c},i["default"].fn.filterMultiSelect.args={}})($);